!function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([,function(e,t,n){"use strict";var i,s;n.r(t),String.prototype.padStart||(String.prototype.padStart=function(e,t){return e>>=0,t=String(t||" "),this.length>e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),t.slice(0,e)+String(this))}),function(e){e[e.Add=0]="Add",e[e.Edit=1]="Edit",e[e.Reproduce=2]="Reproduce",e[e.Info=3]="Info",e[e.Remove=4]="Remove",e[e.Find=5]="Find",e[e.ClearFind=6]="ClearFind",e[e.SelectLocalFiles=7]="SelectLocalFiles",e[e.IsSelected=8]="IsSelected",e[e.ToState=9]="ToState"}(i||(i={})),function(e){e[e.Disable=0]="Disable",e[e.Enable=1]="Enable"}(s||(s={}));class o{constructor(e,t,n,i,s){this._modal=e,this._header=t,this._content=n,this._yes=i,this._no=s}static get instance(){return this._instance}static Create(e,t,n,i,s){o._instance||(this._instance=new o(e,t,n,i,s))}get nameEventDeleteConfirm(){return"modalConfirm-delete-confirm"}get nameEventDeleteRefuse(){return"modalConfirm-delete-refuse"}get nameEventSureConfirm(){return"modalConfirm-sure-confirm"}get nameEventSureRefuse(){return"modalConfirm-sure-refuse"}get nameEventCaution(){return"modalConfirm-caution"}get eventDeleteConfirm(){return new CustomEvent(this.nameEventDeleteConfirm,{bubbles:!0})}get eventDeleteRefuse(){return new CustomEvent(this.nameEventDeleteRefuse,{bubbles:!0})}get eventCaution(){return new CustomEvent(this.nameEventCaution,{bubbles:!0})}OpenConfirmDelete(e,t=null){this._header.innerText="Подтвердите удаление",this._content.innerText=e,this.SetButtonDefault(),t?(this._yes.onclick=()=>{document.dispatchEvent(new CustomEvent(this.nameEventDeleteConfirm,{bubbles:!0,detail:{resolve:t("yes")}}))},this._no.onclick=()=>{document.dispatchEvent(new CustomEvent(this.nameEventDeleteRefuse,{bubbles:!0,detail:{resolve:t("no")}}))}):(this._yes.onclick=()=>{document.dispatchEvent(this.eventDeleteConfirm)},this._no.onclick=()=>{document.dispatchEvent(this.eventDeleteRefuse)}),this._modal.style.display="block"}OpenSure(e){this._header.innerText="Are you sure?",this._content.innerText="Please confirm the action",this.SetButtonDefault(),this._yes.onclick=()=>{document.dispatchEvent(new CustomEvent(this.nameEventSureConfirm,{bubbles:!0,detail:{resolve:e("yes")}}))},this._no.onclick=()=>{document.dispatchEvent(new CustomEvent(this.nameEventSureRefuse,{bubbles:!0,detail:{resolve:e("no")}}))},this._modal.style.display="block"}OpenCaution(e){this._header.innerText="!!! Внимание",this._content.innerText=e,this.SetButtonCaution(),this._yes.onclick=()=>{document.dispatchEvent(this.eventCaution)},this._modal.style.display="block"}SetButtonDefault(){this.ToVisibilityBtn(this._yes),this.ToVisibilityBtn(this._no),this._yes.innerText="Confirm",this._no.innerText="Refuse"}SetButtonCaution(){this.ToVisibilityBtn(this._yes),this.ToUnVisibilityBtn(this._no),this._yes.innerText="OK"}ToVisibilityBtn(e){e.style.position="static",e.style.visibility="visible"}ToUnVisibilityBtn(e){e.style.position="absolute ",e.style.visibility="hidden"}}o._instance=void 0;class r{constructor(e,t,n,i,s){this._name=e,this._typeAction=t,this._state=n,this._action=i,this._context=s}get name(){return this._name}get typeAction(){return this._typeAction}get state(){return this._state}set state(e){this._state=e,document.dispatchEvent(this.eventChangeState)}get isEnabled(){return this.state==s.Enable}get eventChangeState(){return new CustomEvent(r.eventNameChangeState,{bubbles:!0,detail:{command:this}})}Execute(){this.isEnabled&&this._action.call(this._context)}}r.eventNameChangeState="command-change-state";class a{constructor(e){this._count=0,this._value=e;let t=new Date(Date.now());this._dateCreate=`${t.toLocaleDateString()} ${t.toLocaleTimeString()}.${t.getMilliseconds()}`}get value(){return this._value}get dateCreate(){return this._dateCreate}set dateCreate(e){this._dateCreate=e}get count(){return this._count}set count(e){this._count=e}Equals(e){return e.count==this.count}toString(){return` ${this._count.toString().padStart(a.maxLengthCount)} | ${this._value.padEnd(a.maxLengthValue)} | ${this._dateCreate} `}}class l{constructor(){this._isSorted=!1,this._isReverseSorted=!1,this._sequence=0,this.data=[]}get maxLengthCount(){return this._sequence.toString().length}get length(){return this.data.length}get list(){return this.Sorted(),this.GetValues()}get reverseList(){return this.ReverseSorted(),this.GetValues()}get firstItem(){return 0!=this.data.length?this.data[0]:void 0}get lastItem(){return 0!=this.data.length?this.data[this.data.length-1]:void 0}add(e){e.count=++this._sequence,this.data.every(t=>!t.Equals(e))&&(this.data.push(e),this._isSorted=!1,this._isReverseSorted=!1)}loadItem(e){this.data.every(t=>!t.Equals(e))&&(this._sequence=e.count>this._sequence?e.count:this._sequence,this.data.push(e),this._isSorted=!1,this._isReverseSorted=!1)}remove(e){this.data.splice(this.data.indexOf(e),1)}toString(){return this.ReverseSorted(),this.data.reduce((e,t)=>`${e}\n${t.toString()}`,"")}Sorted(){this._isSorted||(this.data=this.data.sort((e,t)=>e.count-t.count),this._isSorted=!0,this._isReverseSorted=!1)}ReverseSorted(){this._isReverseSorted||(this.data=this.data.sort((e,t)=>t.count-e.count),this._isSorted=!1,this._isReverseSorted=!0)}*GetValues(){for(let e=0;e<this.data.length;e++)yield this.data[e]}}let h=(()=>{class e{constructor(t,n){this._isMarkAll=!1,this._eventChangeMarkRow=new CustomEvent("changeMarkRow",{bubbles:!0,detail:{content:this}}),this._checkBox=t,this._img=n,this._img.src=e.imgCheckBlankOutlineBlack,this._checkBox.addEventListener("change",()=>{this.OnChange()},!1)}get valueString(){return this._valueString}set valueString(e){this._valueString=e}get row(){return this._row}set row(e){this._row=e}get isMarkAll(){return this._isMarkAll}get checked(){return this._checkBox.checked}set checked(e){this._checkBox.checked=e}get isDisable(){return this._checkBox.disabled}set isDisable(e){this._checkBox.disabled=e}OnChange(){this._checkBox.checked?this._img.src=e.imgCheckBoxOutline:this._img.src=e.imgCheckBlankOutlineBlack,document.dispatchEvent(this._eventChangeMarkRow)}}return e.imgCheckBlankOutlineBlack="../../img/checkbox-blank-outline-black.png",e.imgCheckBoxOutline="../../img/check-box-outline.png",e})();class c extends h{constructor(e,t){super(e,t),this.isDisable=!0,this._isMarkAll=!0,this._eventChangeMarkRow=new CustomEvent("changeMarkAllRows",{bubbles:!0,detail:{content:this}})}}class d{constructor(e){this.type="valueString",this.count=e}}class u{constructor(e,t){this.value=e,this.created=t}}new class{constructor(e,t,n,i,s,o,r,h,d,u,m,g,_){this._collection=new l,this._markRows=[],this._enter=e,this._field=t,this._counter=n,this._tableOfLog=i,this._markAllRows=new c(s,o),this._remove=r,this._logRowHeader=h,this._modalConfirm=d,this._modalConfirmYes=u,this._modalConfirmNo=m,this._confirmHeader=g,this._confirmAbout=_,this._field.maxLength=this.maxLength,a.maxLengthValue=this.maxLength,this.SetEvents(),this.toEnterDisabled=!0,this.toRemoveDisabled=!0,this.InitCollection(),this.SetCounter()}get maxLength(){return 160}get isString(){return isNaN(+this._field.value)}set toVerify(e){this._field.dataset.verify=e}set toEnterDisabled(e){this._enter.disabled=e}set toRemoveDisabled(e){this._remove.disabled=e}get countRemove(){return this._markRows.reduce((e,t)=>e+(t.checked?1:0),0)}get isMarkedRemove(){return this.countRemove>0}SetEvents(){o.Create(this._modalConfirm,this._confirmHeader,this._confirmAbout,this._modalConfirmYes,this._modalConfirmNo),this._field.addEventListener("input",()=>{this.isString?(this.toVerify="true",this.toEnterDisabled=!1,this.SetCounter()):(this.toVerify="false",this.toEnterDisabled=!0,this.ClearCounter())},!1),this._enter.addEventListener("click",e=>{this.OnEnter(e)},!1),this._remove.addEventListener("click",()=>{this.OnRemove()},!1),document.addEventListener("changeMarkRow",e=>{this.OnChangeMarkRow()},!1),document.addEventListener("changeMarkAllRows",e=>{this.OnChangeMarkAllRows()},!1),this._logRowHeader.addEventListener("click",e=>{this.OnClickRowLog(e)},!1),document.addEventListener(o.instance.nameEventDeleteConfirm,()=>{this.OnDeleteConfirm()},!1),document.addEventListener(o.instance.nameEventDeleteRefuse,()=>{this.OnDeleteRefuse()},!1),document.addEventListener(o.instance.nameEventCaution,()=>{this.OnCaution()},!1)}OnEnter(e){e.preventDefault(),this._collection.add(new a(this._field.value)),a.maxLengthCount=this._collection.maxLengthCount,this.toVerify="false",this.toEnterDisabled=!0,this._field.value="",this.SetCounter(),this._markAllRows.isDisable=!1,this.ShowLogItem(this._collection.lastItem),this.SetToStorage(this._collection.lastItem),this.OnChangeMarkRow()}OnRemove(){o.instance.OpenConfirmDelete(`Удалить ${this.countRemove} из ${this._markRows.length}`)}SetCounter(){this._counter.innerText=`${this._field.value.length} /${this.maxLength}`}ClearCounter(){this._counter.innerText="0/"+this.maxLength}ShowLogItem(e){let t=document.createElement("div");t.className="row",t.dataset.count=e.count.toString(),t.addEventListener("click",e=>{this.OnClickRowLog(e)},!1);let n=document.createElement("div");n.className="cell w1prc cell-horizontal-center cell-vertical-center";let i=document.createElement("input");i.type="checkbox",i.id=e.count.toString(),n.appendChild(i);let s=document.createElement("label");s.htmlFor=i.id;let o=document.createElement("img");s.appendChild(o),n.appendChild(s);let r=new h(i,o);r.valueString=e,r.row=t,this._markRows.push(r),t.appendChild(n),n=document.createElement("div"),n.className="cell w5prc cell-h-right",n.textContent=e.count.toString(),t.appendChild(n),n=document.createElement("div"),n.className="cell w70prc",n.textContent=e.value,t.appendChild(n),n=document.createElement("div"),n.className="cell cell-h-right fsize-0x7rem",n.textContent=e.dateCreate,t.appendChild(n),this._tableOfLog.insertBefore(t,this._tableOfLog.firstChild)}OnChangeMarkRow(){this.isMarkedRemove?(this.toRemoveDisabled=!1,this._remove.innerText=`Удалить (${this.countRemove} из ${this._markRows.length})`):(this.toRemoveDisabled=!0,this._remove.innerText="Удалить")}OnChangeMarkAllRows(){for(let e of this._markRows)e.checked=this._markAllRows.checked,e.OnChange()}OnClickRowLog(e){if("log-row-header"===e.target.parentElement.id)this._markAllRows.isDisable||(this._markAllRows.checked=!this._markAllRows.checked,this._markAllRows.OnChange());else if(e.target.parentElement.dataset.count){let t=this._markRows.find(t=>t.valueString.count===Number(e.target.parentElement.dataset.count));t.checked=!t.checked,t.OnChange()}}OnDeleteConfirm(){let e=this._markRows.filter(e=>e.checked);for(let t of e)this._tableOfLog.removeChild(t.row),this.RemoveFromStorage(t.valueString),this._collection.remove(t.valueString),this._markRows.splice(this._markRows.indexOf(t),1);this._markAllRows.checked=!1,this.OnChangeMarkRow(),0===this._collection.length&&0===this._markRows.length?this._markAllRows.isDisable=!0:this._collection.length===this._markRows.length||console.log(`error with delete: collection.length = ${this._collection.length}, markRows.length = ${this._markRows.length}`),this._modalConfirm.style.display="none"}OnDeleteRefuse(){this._modalConfirm.style.display="none"}OnCaution(){this._modalConfirm.style.display="none"}SetToStorage(e){try{let t=new d(e.count);localStorage.setItem(JSON.stringify(t),JSON.stringify(new u(e.value,e.dateCreate)))}catch(e){o.instance.OpenCaution(e.message)}}RemoveFromStorage(e){try{let t=new d(e.count);localStorage.removeItem(JSON.stringify(t))}catch(e){o.instance.OpenCaution(e.message)}}InitCollection(){for(let e=0;e<localStorage.length;e++)try{let t=JSON.parse(localStorage.key(e)),n=JSON.parse(localStorage.getItem(JSON.stringify(t)));if(null!=t.count){let e=new a(n.value);e.count=t.count,e.dateCreate=n.created,this._collection.loadItem(e)}}catch(e){}if(this._collection.length>0){for(let e of this._collection.list)this.ShowLogItem(e);this._markAllRows.isDisable=!1}}}(document.getElementById("enter"),document.getElementById("stringVal"),document.getElementById("counter"),document.getElementById("tableOfLog"),document.getElementById("markAllRows"),document.getElementById("imgMarkAllRows"),document.getElementById("remove"),document.getElementById("log-row-header"),document.getElementById("confirm-modal"),document.getElementById("confirmYes"),document.getElementById("confirmNo"),document.getElementById("confirm-modal-Header"),document.getElementById("confirmAbout"))}]);